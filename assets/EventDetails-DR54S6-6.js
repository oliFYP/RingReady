import{u as U,k as I,l as Y,r as c,j as e,L as D,m as O,a as q,n as Q,f as V,b as z,p as G,c as H,s as b,h as j,t as f,v as F,w as T,x as M}from"./index-EEsZY6UW.js";import{f as p}from"./format-sbWH3_uq.js";function X(){const{id:d}=U(),{currentUser:n,userProfile:i}=I(),v=Y(),[A,g]=c.useState(null),[C,P]=c.useState(!0),[x,o]=c.useState(null),[r,u]=c.useState(1),[N,y]=c.useState(!1),[L,w]=c.useState(!1),[k,E]=c.useState(!1),[B,S]=c.useState(!1);c.useEffect(()=>{async function l(){var a;try{const t=b(j,"events",d),h=await f(t);if(h.exists()){const m={id:h.id,...h.data(),date:((a=h.data().date)==null?void 0:a.toDate())||new Date};g(m),n&&m.attendees&&m.attendees.includes(n.uid)&&w(!0),n&&(i==null?void 0:i.role)==="boxer"&&m.boxers&&m.boxers.includes(n.uid)&&S(!0)}else o("Event not found")}catch(t){console.error("Error fetching event:",t),o("Failed to load event details")}finally{P(!1)}}l()},[d,n,i]);const J=async()=>{var l;if(!n){v("/login",{state:{from:`/events/${d}`}});return}try{y(!0);const a=b(j,"events",d);await F(a,{attendees:M(n.uid),ticketsSold:T(r),remaining:T(-r)}),w(!0);const t=await f(a);t.exists()&&g({id:t.id,...t.data(),date:((l=t.data().date)==null?void 0:l.toDate())||new Date})}catch(a){console.error("Error purchasing tickets:",a),o("Failed to purchase tickets")}finally{y(!1)}},$=async()=>{var l;if(!n){v("/login",{state:{from:`/events/${d}`}});return}if((i==null?void 0:i.role)!=="boxer"){o("Only users with boxer role can join as fighters");return}try{E(!0);const a=b(j,"events",d);await F(a,{boxers:M(n.uid)}),S(!0);const t=await f(a);t.exists()&&g({id:t.id,...t.data(),date:((l=t.data().date)==null?void 0:l.toDate())||new Date})}catch(a){console.error("Error joining as boxer:",a),o("Failed to join as boxer")}finally{E(!1)}},R={title:"Amateur Boxing Championship",description:"A showcase of the best amateur boxing talent in the region. This event features multiple weight divisions and competitors of all skill levels. Come watch the future stars of boxing as they compete for regional titles and recognition.",location:"Downtown Arena, New York",date:new Date(Date.now()+7*24*60*60*1e3),time:"7:00 PM",ticketPrice:25,capacity:200,remaining:120,imageUrl:"https://images.pexels.com/photos/4761671/pexels-photo-4761671.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"},s=A||R;return e.jsx("div",{className:"pt-16 min-h-screen",children:C?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-lg font-medium text-gray-700",children:"Loading event details..."})]})}):x?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center max-w-md mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Error"}),e.jsx("p",{className:"text-gray-600 mb-8",children:x}),e.jsx(D,{to:"/events",className:"btn-primary",children:"Back to Events"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${s.imageUrl||"https://images.pexels.com/photos/4761679/pexels-photo-4761679.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"})`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-dark/80 to-dark/60"})}),e.jsx("div",{className:"relative container-custom py-20",children:e.jsxs(O.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-white max-w-4xl",children:[e.jsx("h1",{className:"mb-4",children:s.title}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-6 text-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"mr-2 text-primary-500"}),e.jsx("span",{children:p(s.date,"EEEE, MMMM d, yyyy")})]}),e.jsx("div",{className:"hidden md:block h-4 w-px bg-gray-400 mx-2"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"mr-2 text-primary-500"}),e.jsx("span",{children:s.time||"7:00 PM"})]}),e.jsx("div",{className:"hidden md:block h-4 w-px bg-gray-400 mx-2"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"mr-2 text-primary-500"}),e.jsx("span",{children:s.location})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("span",{className:"inline-flex items-center bg-primary-600 text-white px-4 py-1 rounded-full text-lg font-medium",children:[e.jsx(z,{className:"mr-2"}),"$",s.ticketPrice]}),e.jsxs("span",{className:"inline-flex items-center bg-gray-700 text-white px-4 py-1 rounded-full text-lg",children:[e.jsx(G,{className:"mr-2"}),s.remaining,"/",s.capacity," Seats Available"]})]})]})})]}),e.jsx("section",{className:"section bg-white",children:e.jsx("div",{className:"container-custom",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"About This Event"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:s.description})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Event Schedule"}),e.jsxs("div",{className:"border-l-4 border-primary-500 pl-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"font-semibold text-xl",children:[p(s.date,"h:mm a")," - Doors Open"]}),e.jsx("p",{className:"text-gray-600",children:"Attendees can enter the venue"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"font-semibold text-xl",children:[p(new Date(s.date.getTime()+60*60*1e3),"h:mm a")," ","- First Bout"]}),e.jsx("p",{className:"text-gray-600",children:"Opening matches begin"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-xl",children:[p(new Date(s.date.getTime()+3*60*60*1e3),"h:mm a")," ","- Main Event"]}),e.jsx("p",{className:"text-gray-600",children:"Featured match of the evening"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Venue Information"}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-xl mb-2",children:s.location}),e.jsx("p",{className:"text-gray-700 mb-4",children:"The venue is equipped with state-of-the-art boxing facilities and comfortable seating for all attendees."}),e.jsx("div",{className:"aspect-w-16 aspect-h-9 rounded-lg overflow-hidden",children:e.jsx("div",{className:"w-full h-64 bg-gray-300 rounded-lg"})})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24",children:[e.jsxs("div",{className:"card p-6 mb-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Purchase Tickets"}),x&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:x}),L?e.jsxs("div",{className:"bg-green-100 text-green-700 p-4 rounded-lg mb-4",children:[e.jsx("h4",{className:"font-bold mb-2",children:"Tickets Purchased!"}),e.jsx("p",{children:"You're all set to attend this event."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>u(Math.max(1,r-1)),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-l",disabled:r<=1,children:"-"}),e.jsx("input",{type:"number",min:"1",max:s.remaining,value:r,onChange:l=>u(Math.min(s.remaining,Math.max(1,parseInt(l.target.value)||1))),className:"w-16 text-center py-2 border-t border-b border-gray-300"}),e.jsx("button",{onClick:()=>u(Math.min(s.remaining,r+1)),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-r",disabled:r>=s.remaining,children:"+"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Ticket Price:"}),e.jsxs("span",{children:["$",s.ticketPrice]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Quantity:"}),e.jsxs("span",{children:["x",r]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg mt-2 pt-2 border-t",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",s.ticketPrice*r]})]})]}),e.jsx("button",{onClick:J,disabled:N||s.remaining<1,className:"btn-primary w-full",children:N?"Processing...":"Purchase Tickets"}),!n&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2 text-center",children:["You'll need to"," ",e.jsx(D,{to:"/login",className:"text-primary-600 hover:text-primary-700",children:"sign in"})," ","to complete your purchase"]})]})]}),(i==null?void 0:i.role)==="boxer"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Join as Boxer"}),B?e.jsxs("div",{className:"bg-green-100 text-green-700 p-4 rounded-lg mb-4",children:[e.jsx("h4",{className:"font-bold mb-2",children:"Application Submitted!"}),e.jsx("p",{children:"You've successfully applied to participate in this event as a boxer."})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-700 mb-4",children:"Interested in competing at this event? Submit your application to join as a boxer."}),e.jsxs("button",{onClick:$,disabled:k,className:"btn flex items-center justify-center gap-2 w-full bg-secondary-500 text-dark hover:bg-secondary-600",children:[e.jsx(H,{}),k?"Submitting...":"Apply to Compete"]})]})]})]})})]})})})]})})}export{X as default};
